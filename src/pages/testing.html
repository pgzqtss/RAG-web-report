<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Testing - Rag-n-Bones</title>

  <!-- Favicons -->
  <link href="../../assets/img/favicon.png" rel="icon" />
  <link href="../../assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

  <!-- Fonts & CSS -->
  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;700&family=Nunito:wght@700&display=swap" rel="stylesheet" />
  <link href="../../assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
  <link href="../../assets/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet" />
  <link href="../../assets/vendor/aos/aos.css" rel="stylesheet" />
  <link href="../../assets/css/main.css" rel="stylesheet" />

  <style>
    pre code {
      display: block;
      background-color: #f4f6f8; /* 浅灰蓝色背景 */
      color: #2d2d2d;            /* 深灰色文字 */
      padding: 16px;
     border-radius: 8px;
     border: 1px solid #d0d7de;
      font-family: 'Courier New', monospace;
     font-size: 14px;
     overflow-x: auto;
     white-space: pre-wrap;
      word-break: break-word;
    }
    [id]::before {
      content: "";
      display: block;
      height: 100px; /* header 高度 */
      margin-top: -100px;
      visibility: hidden;
    }
    
    #header {
      transition: all 0.6s ease;
    }

    .testing-hero {
      background: linear-gradient(90deg, #4ca1af, #c4e0e5);
      color: #fff;
      padding: 120px 0 60px;
      text-align: center;
    }

    .testing-hero h1 {
      font-family: 'Nunito', sans-serif;
      font-size: 48px;
      font-weight: 700;
    }

    .content-wrapper {
      display: flex;
      gap: 2rem;
    }

    .main-content {
      flex: 3;
    }

    .sidebar-nav {
      flex: 1;
      position: sticky;
      top: 120px;
      height: fit-content;
    }

    .sidebar-nav ul {
      padding-left: 0;
      list-style: none;
    }

    .sidebar-nav a {
      text-decoration: none;
      color: #388da8;
      display: block;
      padding: 8px 0;
    }

    .sidebar-nav a:hover {
      color: #145374;
    }

    .testing-section {
      padding: 60px 0;
    }

    .testing-section h2 {
      color: #3399ff;
      font-weight: 700;
      font-size: 28px;
      margin-top: 40px;
    }

    .testing-section p {
      line-height: 1.8;
    }

    @media (max-width: 991px) {
      .content-wrapper {
        flex-direction: column;
      }

      .sidebar-nav {
        position: static;
      }
    }
  </style>
</head>

<body>
  <!-- Header -->
  <header id="header" class="header d-flex align-items-center fixed-top bg-white shadow-sm">
    <div class="container-fluid container-xl d-flex align-items-center">
      <a href="../../index.html" class="logo d-flex align-items-center me-auto">
        <img src="../../assets/img/logo.png" alt="Logo" style="height: 32px; margin-right: 10px;" />
        <h1 class="sitename mb-0">Rag-n-Bones</h1>
      </a>

      <nav id="navmenu" class="navmenu">
        <ul class="d-flex list-unstyled mb-0">
          <li><a href="../../index.html">Home</a></li>
          <li><a href="requirements.html">Requirements</a></li>
          <li><a href="research.html">Research</a></li>
          <li><a href="algorithm.html">Algorithm</a></li>
          <li><a href="system-design.html">System Design</a></li>
          <li><a href="implements.html">Implements</a></li>
          <li><a class="active" href="testing.html">Testing</a></li>
          <li><a href="evaluation.html">Evaluation</a></li>
          <li><a href="appendix.html">Appendix</a></li>
        </ul>
      </nav>

      <a class="btn btn-primary ms-3 rounded-pill px-4" href="../../index.html">Get Started</a>
    </div>
  </header>

  <!-- Hero -->
  <section class="testing-hero" data-aos="fade-down">
    <div class="container">
      <h1>Testing</h1>
      <p class="lead">To ensure quality in our project we used User Acceptance and Unit Testing</p>
    </div>
  </section>

  <!-- Content -->

  
  <section class="testing-section">
    <div class="container content-wrapper">
      <!-- Left Column -->
      <div class="main-content" data-aos="fade-up">
        <h2 id="strategy">Testing Strategy</h2>
        <p>To validate the correctness, robustness, and efficiency of our RAG pipeline system, we employed a combination of unit testing, integration testing, and efficiency benchmarking. Given the multi-stage nature of our backend system—including PDF processing, embedding generation, query-based summarisation, and history storage—each layer was tested independently and jointly to ensure end-to-end consistency.
          The system interacts with real files, vector databases (Pinecone), and a MySQL backend. As such, it was essential to both isolate logic during development, and test the entire pipeline during production-level simulation.
          We also implemented automated reporting using pytest-html and benchmark tests to measure how system performance scaled with increasing workloads (i.e., number of papers uploaded).</p>
        <h3 id="scope" class="mt-4">Testing Scope</h3>
        <P>Our RAG-based system handles PDF ingestion, semantic vector embedding, question-answering, systematic review generation, and user history storage. As such, the scope of our testing spans a variety of functional, boundary, and integration scenarios to ensure robustness, correctness, and a reliable user experience.</P>
        <ol>
        <li>PDF Upload and Preprocessing: Users can upload research papers in PDF format, which are then parsed, chunked, and processed.ensured the upload and parsing pipeline works correctly across edge cases without crashing or producing malformed data.</li>
        <li>Embedding and Vector Database Integration: The system relies on transforming parsed content into semantic embeddings and storing them in a vector database (Pinecone).We confirmed that each document chunk is processed and stored in Pinecone or gracefully handled in fallback mode if needed.</li>
        <li>Query Processing and Systematic Review Generation: We simulated realistic and malformed user queries to evaluate the end-to-end RAG pipeline, ensured that the system invokes the generation model correctly and returns structured outputs, covering sections such as Background, Methods, Results, and Conclusion.</li>
        <li>User History Storage and Database Integrity: Each completed review is saved to a MySQL backend for traceability, verified the system's ability to handle database writes reliably and reject invalid input gracefully.</li>
        </ol>

        <h2 id="unit-testing">Unit Testing</h2>
        <p>We utilized unit testing extensively to verify the correctness and robustness of individual components and functions within our backend system. Each function and route handler within our Flask application—such as database utilities, embedding modules, PDF processing functions, and route-level logic—were independently tested. These unit tests run in isolation, allowing us to quickly identify and resolve any issues early in the development process.</p>
        <p>Testing Frameworks: We leveraged pytest as our primary unit testing framework, benefiting from its simple syntax, flexible assertion system, and rich ecosystem. To facilitate testing of external dependencies such as the database or Pinecone, we employed pytest-mock to mock these external services, simulating various behaviors and ensuring our code handled these conditions gracefully.</p>
        <p>For example, in our route tests, we verified that each endpoint could correctly handle invalid inputs or missing fields without causing unintended crashes:</p>
        <pre><code># backend/test/integration/test_save_history.py
    def test_save_history_wrong_types(client):
        payload = {
            "user_id": ["invalid_id"],  # should be integers
            "prompt_id": "invalid_prompt_id",  # should be integer
            "prompt": "Sample prompt",
            "systematic_review": "Sample review"
        }
        response = client.post("/api/save", json=payload)
        assert response.status_code == 400
    </code></pre>
    
        <h2 id="integration-testing">Integration Testing</h2>
        <p>Integration tests were developed to verify the correct interaction between multiple components across the RAG pipeline—PDF upload, vector embedding, systematic review generation, and history storage in the database. These tests simulate realistic end-to-end scenarios, ensuring the entire system operates cohesively as intended.</p>
        <p>Testing Frameworks: We primarily used pytest combined with Flask’s built-in test client to simulate HTTP requests to our API endpoints. Integration tests often involved multiple API requests sequentially, mimicking actual user interactions with our system. By creating dedicated test scenarios that included PDF file uploads, prompt queries, and historical data storage, we ensured comprehensive coverage of realistic workflows.</p>
        <pre><code># backend/test/integration/test_full_pipeline.py
    def test_full_rag_pipeline(client):
        prepare_test_files()
        
        response_upsert = client.post("/api/upsert", json={"id": "test_user"})
        assert response_upsert.status_code == 200
        
        response_generate = client.post("/api/generate", json={"id": "test_user", "prompt": "Effects of MSCs in COVID-19?"})
        assert response_generate.status_code == 200
        
        review = response_generate.get_json().get("systematic_review", "")
        assert "background" in review.lower()
        
        response_save = client.post("/api/save", json={
            "user_id": [1],
            "prompt_id": 999,
            "prompt": "Effects of MSCs in COVID-19?",
            "systematic_review": review
        })
        assert response_save.status_code == 200
    </code></pre>

        <div class="row mt-4">
          <div class="col-md-6">
            <img src="../../assets/img/TEST1.png" alt="Test 1" class="img-fluid rounded shadow">
          </div>
          <div class="col-md-6">
            <img src="../../assets/img/TEST2.png" alt="Test 2" class="img-fluid rounded shadow">
          </div>
        </div>
        <h2 id="test-coverage">Test Coverage</h2>
        <p>We used pytest for unit testing and used pytest-cov plugin to generate a test coverage report as below. The coverage report indicated that 86% of our codebase is covered by tests.</p>

        <div class="row mt-4">
          <div class="col-12">
            <img src="../assets/test_coverage.png" alt="Test Coverage Report" class="img-fluid rounded shadow mb-4">
          </div>
        </div>


        <section class="testing-section" id="acceptance">
          <div class="container" data-aos="fade-up">
            <h2>User Acceptance Testing</h2>
        
            <p>To gain a general understanding of how our application performs and to identify potential areas for improvement, we invited four individuals from diverse backgrounds to test our application. Their feedback was recorded and analyzed to inform future enhancements.</p>
        
            <h5 class="mt-4">TESTERS</h5>
            <p>The testers include:</p>
            <ul>
              <li>Alice - 18 years old student</li>
              <li>Brian - 25 years old bank employee</li>
              <li>Cathy - 39 years old doctor</li>
              <li>David - 45 years old Researcher</li>
            </ul>
            <p><em>Note: These are all real-world testers, however, their identities have been made anonymous.</em></p>
        
            <h5 class="mt-4">TEST CASE</h5>
            <p>We divided the test into 4 cases, the testers would go through each case and give feedbacks. The feedbacks were based on the acceptance requirements given to the testers, where they would rate each requirement at Likert Scale as well as leave custom comments.</p>
        
            <p><strong>Test Case 1:</strong> We asked the testers to login and provided testers with 3 to 5 medical research papers in PDF format and asked them to upload the documents using the system interface.</p>
            <p><strong>Test Case 2:</strong> Testers were instructed to input a valid prompt or any questions related to the papers and generate a systematic review.</p>
            <p><strong>Test Case 3:</strong> Once the review was generated, testers were asked to save it and review both the written summary and the accompanying visualizations.</p>
            <p><strong>Test Case 4:</strong> We also provided testers with intentionally flawed input, such as blank PDFs or vague prompts to simulate some extreme use cases.</p>
        
            <h5 class="mt-4">Feedback from Users</h5>
<div class="table-responsive">
  <table class="table table-bordered align-middle text-center">
    <thead class="table-light">
      <tr>
        <th class="text-start">Acceptance Requirement</th>
        <th>Strongly Disagree</th>
        <th>Disagree</th>
        <th>Agree</th>
        <th>Strongly Agree</th>
        <th class="text-start">Comments</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td class="text-start">Is the UI navigation easy?</td>
        <td>0</td><td>0</td><td>0</td><td>4</td>
        <td class="text-start">+ The navigation bar makes it easy.</td>
      </tr>
      <tr>
        <td class="text-start">Interface is clean and workflow is clear</td>
        <td>0</td><td>0</td><td>0</td><td>4</td>
        <td class="text-start">+ The layout is intuitive.</td>
      </tr>
      <tr>
        <td class="text-start">Clear response to every user action</td>
        <td>0</td><td>0</td><td>1</td><td>3</td>
        <td class="text-start">+ Suggest adding animations or visual cues</td>
      </tr>
      <tr>
        <td class="text-start">Attachments can be uploaded successfully</td>
        <td>0</td><td>0</td><td>0</td><td>4</td>
        <td class="text-start">+ Single and multiple PDFs both worked</td>
      </tr>
      <tr>
        <td class="text-start">Systematic review output is well-structured</td>
        <td>0</td><td>0</td><td>0</td><td>4</td>
        <td class="text-start">+ Surprisingly coherent across prompt styles</td>
      </tr>
      <tr>
        <td class="text-start">Cross-browser compatibility</td>
        <td>0</td><td>0</td><td>0</td><td>4</td>
        <td class="text-start">+ Chrome and Edge tested successfully</td>
      </tr>
      <tr>
        <td class="text-start">System response speed</td>
        <td>0</td><td>0</td><td>2</td><td>2</td>
        <td class="text-start">- Chart rendering takes slightly longer</td>
      </tr>
      <tr>
        <td class="text-start">Save history and view past reviews</td>
        <td>0</td><td>0</td><td>0</td><td>4</td>
        <td class="text-start">+ Convenient to access previous Q&A</td>
      </tr>
    </tbody>
  </table>
</div>
        
            <h5 class="mt-4">Overall Feedback & Advice</h5>
            <blockquote class="blockquote">
              “It would be nice if it can be not only used in medical papers, but also in legal documents or more fields.”
            </blockquote>
            <blockquote class="blockquote">
              “It is nice and impressive. The review and charts can save huge amounts of time compared with reading through all papers.”
            </blockquote>
            <blockquote class="blockquote">
              “Compared with using GPT, this system can generate conclusions more well-structured and the text is richer in content. It is helpful for me to understand the papers quickly and in-depth.”
            </blockquote>
        
            <h5 class="mt-4">Conclusion</h5>
            <p>Testers have expressed satisfaction with the tool and overall interface. However, there is room for improvement in generation speed and scope of use.</p>
          </div>
        </section>
      </div>

      <!-- Right Column Nav -->
      <aside class="sidebar-nav" data-aos="fade-left">
        <h5 class="fw-bold mb-3">On This Page</h5>
        <ul>
          <li><a href="#strategy">Testing Strategy</a></li>
          <li><a href="#unit-testing">Unit Testing</a></li>
          <li><a href="#integration-testing">Integration Testing</a></li>  
          <li><a href="#test-coverage">Test Coverge</a></li>
          <li><a href="#acceptance">User Acceptance</a></li>
        </ul>
      </aside>
    </div>
  </section>

  <!-- Footer -->
  <footer class="footer bg-dark text-white py-5 mt-5">
    <div class="container">
      <div class="row gy-4">
        <div class="col-lg-4">
          <h5>Site Info</h5>
          <p>This is the official site of UCL Year 2 COMP106B Team 4, showcasing the full development lifecycle of our project.</p>
        </div>
        <div class="col-lg-4">
          <h5>Menu</h5>
          <ul class="list-unstyled">
            <li><a href="../../index.html" class="text-white">Home</a></li>
            <li><a href="requirements.html" class="text-white">Requirements</a></li>
            <li><a href="testing.html" class="text-white">Testing</a></li>
          </ul>
        </div>
        <div class="col-lg-4">
          <h5>Supporters</h5>
          <p>Avanade, UCL — with special thanks to Mr. Kenza 404.</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Scripts -->
  <script src="../../assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
  <script src="../../assets/vendor/aos/aos.js"></script>
  <script>
    AOS.init();
  </script>
</body>

</html>